---
layout: post
title: 精通比特币学习笔记
date: 2018-03-20 14:30:00.000000000 +09:00
---

## 第1章 介绍
---

### 1.1 什么是比特币
比特币是一个分布式的点对点网络系统，因此没有中央服务器，也没有中央控制点。比特币是通过一个名为"挖矿"的过程产生的，挖矿需要在处理比特币交易的同时参与竞赛来解决一个数学问题。

在比特币网络的任何参与者都是潜在的矿工。每隔10分钟，有人能够验证过去10分钟发生的交易，作为回报，将会获得新的比特币。

比特币协议包括了内置算法，该算法可以调节网络中的挖矿能力。矿工必须完成的任务——在比特币网络中成功的记录一个区块交易——的难度是在动态调整的。因此，无论多少人在同时挖矿，通常每10分钟就有人成功。

比特币由这些构成：
+ 一个去中心化的点对点网络(比特币协议)
+ 一个公共的交易账簿(区块链)
+ 一个去中心化的数学和确定的货币发型(分布式挖矿)
+ 一个去中心化的交易验证系统(交易脚本)


### 1.2 比特币发展史


### 1.3 比特币的应用、用户和他们的故事


### 1.4 入门
比特币客户端的三种主要形式是:
+ 完整客户端：或称"全节点"，是存储所有比特币交易的整个交易历史的客户端，管理用户的钱包，并可以在比特币网络上直接开始交易。
+ 轻量级客户端：存储用户的钱包，但需要依赖第三方服务器才能进行比特币交易，才能接入比特币网络。轻量级客户端不保存所有交易的完整副本，因此必须信赖第三方的服务器获取交易确认。
+ 在线客户端：完全依赖于第三方服务器
+ 移动客户端：多种类型均可

#### 1.4.1 快速入门



## 第2章 比特币的原理
---

### 2.1 交易、区块、挖矿和区块链
在比特币中，信任是由比特币系统中不同参与者之间交互来达成的一种自然属性。

#### 2.1.1 比特币概述
比特币系统由用户(用户通过密钥控制钱包)、交易(每一笔交易都会被广播到整个比特币网络)和矿工(通过竞争计算生成在每个节点达成共识的区块链，区块链是一个分布式的公共权威账簿，包含了比特币网络发生的所有交易)组成

#### 2.1.2 买咖啡
从千分之一比特币(一毫比特币)到以百万分之一(一聪比特币)，比特币网络可以处理任意小额交易。


### 2.2 比特币交易
简单来说，交易告知全网：比特币的持有者已授权把比特币转账给其他人，而新持有者能够在此授权，转移给比特币所有权链中的其他人，产生另一笔交易来花掉这些比特币。

交易就像复式记账法账簿中的行，简单来说，每一笔交易包含一个或多个"输入"，输入是针对一个毕业币账号的负债。有一个或多个"输出"，被当成信用点数计入到毕业币账户中。这些输入和输出的总额不需要相等，相反，当输出累加略少于输入量时，两者的差额就代表了一笔隐含的"矿工费"，这也是将交易放进账簿的矿工所收集到的一笔小额支付。

交易是将钱从交易输入移至输出。输入是指钱币的来源，通常是前一笔交易的输出。输出则是通过关联一个密钥的方式将钱赋予一个新的所有者，目的密钥被称为是安全锁(Encumbrance)。这样就给资金强加了一个要求：有签名才能在以后的交易中赎回资金。

#### 2.2.1 常见的交易形式
最常见的交易形式是从一个地址到另一个地址的简单支付，这种交易也常常包含给支付者的"找零"。一般交易是有一个输入和两个输出；
另一种常见的交易形式是集合多个输入到一个输出的模式，这种类似于现实中零钱兑换为一个大额面钞。
另一种比特币账簿中常见的交易形式是将一个输入分配给多个输出，即多个接收者的交易，类似发工资的情形。


### 2.3 交易的构建
钱包应用设置可以在完全离线时建立交易，只有在执行交易时才需要将交易发送到网络。

#### 2.3.1 获取正确的输入
大多数钱包应用维护者一个含有用钱包自己密钥锁定的"未消费交易输出"小型数据库。
 
完整的客户端好友整个区块链中所有交易的所有为消费输出副本，这是的钱包技能拿这些输出构建交易，也能在收到新交易时很快的验证其输入是否正确，但是会占用太大的硬盘空间。
所以大多数钱包使用轻量级的客户端，只保存自己的未消费输出。如果钱包客户端没有某一未消费输出，它可以通过不同的服务器提供的各种API或完整索引节点的JSON PRC API从比特币网络中拿到这一交易信息

```
查找比特币地址所有的未消费输出
$curl
https://blockchain.info/unspent?active=1Ce19081308hdwahd0921

返回
{
    "unspent_outputs: [
        {
            "tx_hash": "186f932131...123daedjwqdjaodw",
            "tx_index": 104810202,
            "tx_output_n": 0,
            "script": "76adwahoidjwoiajdpwaodkpawdjpowadkwpao",
            "value": 10000000,
            "value_hex: "00989680",
            "confirmations": 0
        }
    ]
}
```

通过这个信息。钱包应用就可以创建新的交易将钱转账到新地址


#### 2.3.2 创建交易输出
交易的输出会被创建成为一个包含这笔数额的脚本的形式，只能被引入这个脚本的一个解答后才能兑换。

#### 2.3.3 将交易放到总账簿中
这个被钱包应用创建的交易大小为258字节，包含了金额未来所需要的全部信息。现在，这个交易必须被传送到比特币网络中以成为分布式账簿(区块链)的一部分。

##### 2.3.3.1 交易的传送
比特币网络是由参与比特币客户端联接几个其他比特币客户端组成的P2P网络。比特币网络的目的是将交易和区块传播给所有参与者

##### 2.3.3.2 如何传播
Alice(输入方)的钱包应用可以发送新的交易给其他任意一个已连接到互联网的比特币客户端，她的钱包不必连着Bob(输出方)的比特币钱包。

任何比特币网络节点(其他客户端)收到一个之前从没有见过的有效交易时，会立即转发给联接到自身的其他节点。因此，这个交易迅速的从P2P网络中传播开来，几秒内就能到达大多数节点。

##### 2.3.3.3 Bob的视角
Alice的交易一般在几秒内到达Bob钱包应用里，Bob钱包应用会立即确认Alice的交易是一个收入支付，因为它包含能用Bob的私钥兑换的输出。Bob的钱包应用也能够独立地用之前未消费输入来确认这个交易是正确构建的，并且由于包含足够的交易费会被下一个区块包含进去。这是Bob就可以以一个很小的风险假定这个交易会很快被加到区块且被确认。


### 2.4 比特币挖矿


